<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>For Scritch Pigeon.com</title>
    <link rel="stylesheet" type="text/css" href="../static/css/styles.css">
  </head>
  <body>
    <div>
      <!-- SECTION: Table -->
      <table dir="ltr" width="500" border="1" 
        summary="purpose/structure for speech output">
        <caption>
            Table ---> Feeds to Posts 
        </caption>
        <colgroup width="50%" />
        <colgroup id="colgroup" class="colgroup" align="center" valign="middle" title="title" span="2"/>
        <thead>
          <tr>
            <th scope="col">feed_id</th>
            <th scope="col">post_id</th>
            <th scope="col">user_id</th>
          </tr>
        </thead>
        <!-- Table representing feeds to posts junction table. -->
        <tbody>
          {% for id in fp_data %}
          <tr>
            <td>{{ id[0] }}</td>
            <td>{{ id[1] }}</td>
            <td>{{ id[2] }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- SECTION: Form-->
    <div class="formWrapper">
      <form class="miniForm" action="/manytomany" method="POST">
        <h1>Many to Many Operations</h1>
        <p>
            Assignment: Many to Many Relationship
            <br>
            Select an operation: Query the table OR Update existing data
        </p>
        
        <div id="radio">
            <input type="radio" id="select-radio" name="many-radio" value="select" checked>
            <label for="select-radio">Select</label><br>

            <input type="radio" id="update-radio" name="many-radio" value="update">
            <label for="update-radio">Update</label><br>
        </div>
        
        <!-- SELECT: Query Section -->
        <div id="select-section">
            <h3>Query Options:</h3>
            <label>
                <input type="radio" name="query_type" value="by_feed" checked>
                Show posts in a feed
            </label><br>
            <label>
                <input type="radio" name="query_type" value="by_post">
                Show feeds containing a post
            </label><br>
            
            <label for="query_value">Enter ID:</label><br>
            <input type="text" id="query_value" name="query_value"><br>
        </div>
        
        <!-- UPDATE User Input Section -->
        <div id="update-section" style="display:none;">
            <h3>Update Existing Row:</h3>
            <p>Identify the row by current feed_id and post_id, then update feed_id and/or post_id</p>
             
            <label for="current_feed_id">Current feed_id:</label><br>
            <input type="text" id="current_feed_id" name="current_feed_id" required><br>

            <label for="current_post_id">Current post_id:</label><br>
            <input type="text" id="current_post_id" name="current_post_id" required><br>
            
            <label for="new_feed_id">New feed_id (optional):</label><br>
            <input type="text" id="new_feed_id" name="new_feed_id"><br>

            <label for="new_post_id">New post_id (optional):</label><br>
            <input type="text" id="new_post_id" name="new_post_id"><br>
        </div>

        <button type="submit" value="submit">Submit</button>
      </form>
    </div>
    
    <script>
      // Toggle form sections based on radio button selection
      function toggleSections() {
        const selectRadio = document.querySelector('input[name="many-radio"][value="select"]');
        const updateRadio = document.querySelector('input[name="many-radio"][value="update"]');
        const selectSection = document.getElementById('select-section');
        const updateSection = document.getElementById('update-section');
        
        if (selectRadio.checked) {
          // Disable update fields
          updateSection.querySelectorAll('input').forEach(input => input.disabled = true);
          // Enable select fields
          selectSection.querySelectorAll('input').forEach(input => input.disabled = false);
        } else if (updateRadio.checked) {
          // necessary styling :)
          selectSection.style.display = 'none';
          updateSection.style.display = 'block';
          // Disable select fields
          selectSection.querySelectorAll('input').forEach(input => input.disabled = true);
          // Enable update fields
          updateSection.querySelectorAll('input').forEach(input => input.disabled = false);
        }
      }
      
      document.querySelectorAll('input[name="many-radio"]').forEach(radio => {
        radio.addEventListener('change', toggleSections);
      });
      
      // Runs on page load...
      toggleSections();
    </script>
  </body>
</html>
